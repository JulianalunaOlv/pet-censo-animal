<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" href="img/icon-pata-cor-primaria.ico" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <meta name="theme-color" content="#007bff" />
  <link rel="manifest" href="manifest.json" />
  <title>Pet Censo PG</title>
</head>
<body>
  <header>
    <img src="img/PG-logo-horizontal-cor-inovacao-500x196.png" class="img-header" alt="Logo/Brasão PG, versão horizontal colorida">
  </header>
  <main>
    
    <div id="content" class="card p-4">
      <div class="row row-cols-1">
        <h1>FORMULÁRIO CENSO PET</h1>
      </div>
      <section class="p-4">
          <div class="row row-cols-1">
              <h2>Dados do Pet</h2>
          </div>
          <div class="row row-cols-1 row-cols-lg-2">

              <!-- Nome -->
              <div class="col">
                  <div class="mb-3">
                      <label for="nomePet" class="form-label">Nome do Pet</label>
                      <input type="text" class="form-control" id="nomePet" name="nomePet" required>
                  </div>
              </div>

              <!-- Finalidade -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label">Finalidade</label>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="finalidade" id="finalidadeGuarda" value="Guarda">
                          <label class="form-check-label" for="finalidadeGuarda">Guarda</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="finalidade" id="finalidadeCompanhia" value="Companhia">
                          <label class="form-check-label" for="finalidadeCompanhia">Companhia</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="finalidade" id="finalidadeAmbos" value="Guarda e Companhia">
                          <label class="form-check-label" for="finalidadeAmbos">Guarda e Companhia</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="finalidade" id="finalidadeGuia" value="Guia">
                          <label class="form-check-label" for="finalidadeGuia">Guia</label>
                      </div>
                  </div>
              </div>

              <!-- Ano de nascimento -->
              <div class="mb-3">
                  <label class="form-label">Ano estimado de nascimento</label>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2025" value="2025">
                      <label class="form-check-label" for="ano2025">2025</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2024" value="2024">
                      <label class="form-check-label" for="ano2024">2024</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2023" value="2023">
                      <label class="form-check-label" for="ano2023">2023</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2022" value="2022">
                      <label class="form-check-label" for="ano2022">2022</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2021" value="2021">
                      <label class="form-check-label" for="ano2021">2021</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2020" value="2020">
                      <label class="form-check-label" for="ano2020">2020</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2019" value="2019">
                      <label class="form-check-label" for="ano2019">2019</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2018" value="2018">
                      <label class="form-check-label" for="ano2018">2018</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2017" value="2017">
                      <label class="form-check-label" for="ano2017">2017</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2016" value="2016">
                      <label class="form-check-label" for="ano2016">2016</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2015" value="2015">
                      <label class="form-check-label" for="ano2015">2015</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2014" value="2014">
                      <label class="form-check-label" for="ano2014">2014</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2013" value="2013">
                      <label class="form-check-label" for="ano2013">2013</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2012" value="2012">
                      <label class="form-check-label" for="ano2012">2012</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2011" value="2011">
                      <label class="form-check-label" for="ano2011">2011</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="ano2010" value="2010">
                      <label class="form-check-label" for="ano2010">2010</label>
                  </div>
                  <div class="form-check">
                      <input class="form-check-input" type="radio" name="anoNascimento" id="anoAntes2010" value="Antes de 2010">
                      <label class="form-check-label" for="anoAntes2010">Antes de 2010</label>
                  </div>
              </div>


              <!-- Porte -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label">Porte do Pet</label>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="porte" id="porteMenos5kg" value="Menos de 5kg">
                          <label class="form-check-label" for="porteMenos5kg">Menos de 5kg</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="porte" id="porte5a10kg" value="5 a 10kg">
                          <label class="form-check-label" for="porte5a10kg">5 a 10kg</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="porte" id="porte10a15kg" value="10 a 15kg">
                          <label class="form-check-label" for="porte10a15kg">10 a 15kg</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="porte" id="porte15a20kg" value="15 a 20kg">
                          <label class="form-check-label" for="porte15a20kg">15 a 20kg</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="porte" id="porteMais20kg" value="Mais de 20kg">
                          <label class="form-check-label" for="porteMais20kg">Mais de 20kg</label>
                      </div>
                  </div>
              </div>

              <!-- Castrado -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label">Castrado?</label>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="castrado" id="castradoNao" value="Não">
                          <label class="form-check-label" for="castradoNao">Não</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="castrado" id="castradoPublica" value="Sim - Pública">
                          <label class="form-check-label" for="castradoPublica">Sim, rede pública</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="castrado" id="castradoParticular" value="Sim - Particular">
                          <label class="form-check-label" for="castradoParticular">Sim, rede particular</label>
                      </div>
                  </div>
              </div>

              <!-- Microchip -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label">Possui microchip?</label>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="microchip" id="microchipNao" value="Não">
                          <label class="form-check-label" for="microchipNao">Não</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="microchip" id="microchipSim" value="Sim">
                          <label class="form-check-label" for="microchipSim">Sim</label>
                      </div>
                  </div>
              </div>

              <!-- RGA -->
              <div class="col">
                  <div class="mb-3">
                      <label for="rgaPet" class="form-label">Número do RGA</label>
                      <input type="number" class="form-control" id="rgaPet" name="rgaPet">
                  </div>
              </div>

              <!-- Sexo -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label">Sexo do Pet</label>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="sexo" id="sexoFemea" value="Fêmea">
                          <label class="form-check-label" for="sexoFemea">Fêmea</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="sexo" id="sexoMacho" value="Macho">
                          <label class="form-check-label" for="sexoMacho">Macho</label>
                      </div>
                  </div>
              </div>

              <!-- Procedência -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label">Procedência</label>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="procedencia" id="procedenciaComprado" value="Comprado">
                          <label class="form-check-label" for="procedenciaComprado">Comprado</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="procedencia" id="procedenciaAdotado" value="Adotado">
                          <label class="form-check-label" for="procedenciaAdotado">Adotado</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="procedencia" id="procedenciaResgatado" value="Resgatado">
                          <label class="form-check-label" for="procedenciaResgatado">Resgatado</label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="radio" name="procedencia" id="procedenciaGanhado" value="Ganhado">
                          <label class="form-check-label" for="procedenciaGanhado">Ganhado</label>
                      </div>
                  </div>
              </div>

              <!-- Espécie -->
              <div class="col">
                  <div class="mb-3">
                      <label class="form-label" for="especie">Escolha a espécie:</label>
                      <div>
                          <input type="radio" id="cao" name="especie" value="cao" onchange="salvarEspecieLocalStorage()" required>
                          <label for="cao">Cão</label>
                      </div>
                      <div>
                          <input type="radio" id="gato" name="especie" value="gato" onchange="salvarEspecieLocalStorage()" required>
                          <label for="gato">Gato</label>
                      </div>
                  </div>
              </div>

          </div>
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
              <button class="btn btn-primary botao-voltar" onclick="window.location.href='etapa1.html'"><i class="bi bi-arrow-left-short"></i>Voltar</button>
              <button class="btn btn-primary botao-avancar" onclick="window.location.href='etapa3.html'"><i class="bi bi-arrow-right-short"></i>Avançar</button>
          </div>
      </section>
    </div>
  
  
    <div class="container-fluid p-4 card">
        <h2>Cadastros de Pets Realizados</h2>
        <div id="listaCadastros" class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Nome do Pet</th>
                        <th>Espécie</th>
                        <th>Finalidade</th>
                        <th>Ano Nasc.</th>
                        <th>Porte</th>
                        <th>Castrado</th>
                        <th>Microchip</th>
                        <th>RGA</th>
                        <th>Sexo</th>
                        <th>Procedência</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="corpoTabela"></tbody>
            </table>
        </div>
        <div class="d-grid gap-2 col-6 mx-auto">
            <button class="btn btn-success" onclick="sincronizarCadastros()">Sincronizar Pets</button>
        </div>

</main>

  <footer class="container-fluid">
    <div class="container-footer">
      <p class="rodape m-0">
        © <abbr title="Município Estância Balneária de Praia Grande">MEBPG</abbr> Desenvolvido por <abbr title="Secretaria de Planejamento">SEPLAN</abbr> - Secretaria de Planejamento - 2025.
      </p>
    </div>
  </footer>
  
<script>
const nomeLogado = localStorage.getItem("nomeLogado");
// Verifica se o elemento divSpanNomeLogado existe antes de tentar acessá-lo.
// Se esta parte do código estiver em uma página específica para pets, pode não ser necessário.
if (document.getElementById("divSpanNomeLogado")) {
    document.getElementById(
        "divSpanNomeLogado"
    ).textContent = `Usuário Logado: ${nomeLogado}`;
}

const DB_NAME = "MinhaBaseDeDados";
const DB_VERSION = 1; // Deve ser o mesmo que na etapa1.html
const STORE_NAME = "Pet"; // Agora o nome da store é "Pet"

// Abre ou cria o banco de dados
function abrirDB() {
    return new Promise((resolve, reject) => {
        const request = indexedDB.open(DB_NAME, DB_VERSION);
        request.onerror = () => reject("Erro ao abrir o banco de dados.");
        request.onsuccess = () => resolve(request.result);
        // REMOVA o bloco onupgradeneeded daqui. A etapa1.html é responsável por criar as object stores.
        // Se você tiver certeza que 'Pet' é criada em etapa1.html, mantenha como está.
        // Se não tiver certeza e precisar que esta página crie a store, adicione o onupgradeneeded.
    });
}

// Salva ou atualiza um pet
async function salvarPet(pet) {
    const db = await abrirDB();
    const tx = db.transaction(STORE_NAME, "readwrite");
    const store = tx.objectStore(STORE_NAME);
    store.put(pet);
    return tx.complete;
}

// Lista todos os pets
async function listarPets() {
    const db = await abrirDB();
    const tx = db.transaction(STORE_NAME, "readonly");
    const store = tx.objectStore(STORE_NAME);
    const request = store.getAll();
    request.onsuccess = () => renderizarTabela(request.result); // A função renderizarTabela agora exibe pets
}

// // Remove pet (necessário para o botão "Remover" funcionar)
// async function removerPet(id) {
//     const db = await abrirDB();
//     const tx = db.transaction(STORE_NAME, "readwrite");
//     const store = tx.objectStore(STORE_NAME);
//     store.delete(id);
//     return tx.complete;
// }

// Exibe pets na tabela
function renderizarTabela(pets) {
    const tbody = document.getElementById("corpoTabela");
    tbody.innerHTML = "";
    if (pets.length === 0) {
        tbody.innerHTML =
            "<tr><td colspan='12'>Nenhum cadastro de pet encontrado.</td></tr>"; // Mensagem adaptada e colspan ajustado para 12
        return;
    }

    pets.forEach((p) => {
        const tr = document.createElement("tr");
        const displayId = p.id ? p.id.substring(0, 8) + '...' : '-'; // Para IDs grandes na tabela
        tr.innerHTML = `
            <td>${displayId}</td>
            <td>${p.nomePet || "-"}</td>
            <td>${p.especie || "-"}</td>
            <td>${p.finalidade || "-"}</td>
            <td>${p.anoNascimento || "-"}</td>
            <td>${p.porte || "-"}</td>
            <td>${p.castrado || "-"}</td>
            <td>${p.microchip || "-"}</td>
            <td>${p.rgaPet || "-"}</td>
            <td>${p.sexo || "-"}</td>
            <td>${p.procedencia || "-"}</td>
            <td>
                <button class="btn btn-sm btn-info editar-btn" data-id="${
                    p.id
                }">Editar</button>
            </td>
        `;
        tbody.appendChild(tr);
    });
                //     <button class="btn btn-sm btn-danger remover-btn" data-id="${ // Adicionado botão remover
                //     p.id
                // }">Remover</button>

    // Adiciona listeners para os botões de editar pet
    document.querySelectorAll(".editar-btn").forEach((button) => {
        button.addEventListener("click", (event) => {
            const id = event.target.dataset.id;
            carregarPetParaEdicao(id); // Chama a função para carregar dados do pet
        });
    });

    // Adiciona listeners para os botões de remover pet
    document.querySelectorAll(".remover-btn").forEach((button) => {
        button.addEventListener("click", async (event) => {
            const id = event.target.dataset.id;
            if (confirm("Tem certeza que deseja remover este pet?")) {
                try {
                    await removerPet(id); // Chama a função removerPet
                    alert("Pet removido com sucesso!");
                    listarPets(); // Atualiza a lista após remoção
                } catch (error) {
                    console.error("Erro ao remover pet:", error);
                    alert("Ocorreu um erro ao remover o pet.");
                }
            }
        });
    });
}

// Modifique obterDadosFormulario para verificar se está editando e coletar dados do pet
function obterDadosFormulario() {
    const editingId = document.getElementById("content").dataset.editingId;
    return {
        id: editingId || crypto.randomUUID(), // Usa o ID existente se estiver editando, senão gera um novo
        nomePet: document.getElementById("nomePet").value.trim(),
        finalidade: document.querySelector('input[name="finalidade"]:checked')?.value || "",
        anoNascimento: document.querySelector('input[name="anoNascimento"]:checked')?.value || "",
        porte: document.querySelector('input[name="porte"]:checked')?.value || "",
        castrado: document.querySelector('input[name="castrado"]:checked')?.value || "Não", // Valor padrão "Não" se não marcado
        microchip: document.querySelector('input[name="microchip"]:checked')?.value || "Não", // Valor padrão "Não"
        rgaPet: document.getElementById("rgaPet").value.trim(),
        sexo: document.querySelector('input[name="sexo"]:checked')?.value || "",
        procedencia: document.querySelector('input[name="procedencia"]:checked')?.value || "",
        especie: document.querySelector('input[name="especie"]:checked')?.value || "",
    };
}

// Criar uma função para limpar o formulário do pet
function limparFormulario() {
    // Não temos uma tag <form> explícita, então limpamos campo a campo
    document.getElementById("nomePet").value = "";
    document.getElementById("rgaPet").value = "";

    // Desmarca todos os radio buttons
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.checked = false;
    });

    document.getElementById("content").removeAttribute("data-editingId"); // Limpa o ID de edição

    // Reverte o título do formulário para o padrão
    document.querySelector("h1").textContent = "FORMULÁRIO CENSO PET";

    // Reexibe o botão "Avançar" e remove o "Salvar Edição"
    const btnProsseguir = document.querySelector(".botao-prosseguir");
    if (btnProsseguir) {
        btnProsseguir.classList.remove("d-none");
    }
    const btnSalvarEdicao = document.getElementById("btnSalvarEdicao");
    if (btnSalvarEdicao) {
        btnSalvarEdicao.remove(); // Remove o botão Salvar Edição
    }
}

// Busca um pet pelo ID e preenche o formulário
async function carregarPetParaEdicao(id) {
    const db = await abrirDB();
    const tx = db.transaction(STORE_NAME, "readonly");
    const store = tx.objectStore(STORE_NAME);
    const request = store.get(id);

    request.onsuccess = (event) => {
        const pet = event.target.result;
        if (pet) {
            document.getElementById("nomePet").value = pet.nomePet || "";
            document.getElementById("rgaPet").value = pet.rgaPet || "";

            // Preenche todos os radio buttons
            const radioFields = [
                "finalidade", "anoNascimento", "porte", "castrado",
                "microchip", "sexo", "procedencia", "especie"
            ];
            radioFields.forEach(fieldName => {
                if (pet[fieldName]) {
                    const radio = document.querySelector(`input[name="${fieldName}"][value="${pet[fieldName]}"]`);
                    if (radio) {
                        radio.checked = true;
                    }
                }
            });

            // Armazena o ID do registro que está sendo editado
            document.getElementById("content").dataset.editingId = pet.id;

            // Altera o título do formulário para indicar edição
            document.querySelector("h1").textContent = "EDITAR DADOS DO PET";

            // Esconde o botão "Avançar" e mostra um botão de "Salvar Edição"
            document.querySelector(".botao-prosseguir").classList.add("d-none");
            let btnSalvarEdicao = document.getElementById("btnSalvarEdicao");
            if (!btnSalvarEdicao) {
                btnSalvarEdicao = document.createElement("button");
                btnSalvarEdicao.id = "btnSalvarEdicao";
                btnSalvarEdicao.classList.add("btn", "btn-success", "ms-2");
                btnSalvarEdicao.textContent = "Salvar Edição do Pet"; // Texto adaptado
                document
                    .querySelector(".d-grid.gap-2.d-md-flex.justify-content-md-end")
                    .appendChild(btnSalvarEdicao);

                btnSalvarEdicao.addEventListener("click", async () => {
                    const idParaAtualizar =
                        document.getElementById("content").dataset.editingId;
                    if (idParaAtualizar) {
                        const dadosAtualizados = obterDadosFormulario();
                        dadosAtualizados.id = idParaAtualizar; // Garante que o ID é o do registro original

                        // Validação mínima para edição também
                        if (!dadosAtualizados.nomePet.trim()) {
                            alert("Por favor, preencha o Nome do Pet.");
                            document.getElementById("nomePet").focus();
                            return;
                        }
                        if (!document.querySelector('input[name="especie"]:checked')) {
                            alert("Por favor, selecione a Espécie do Pet (Cão ou Gato).");
                            return;
                        }

                        try {
                            await salvarPet(dadosAtualizados); // Chama salvarPet
                            alert("Dados do pet atualizados com sucesso!");
                            listarPets(); // Atualiza a tabela de pets
                            limparFormulario(); // Limpa o formulário e reverte o estado
                        } catch (error) {
                            console.error("Erro ao atualizar pet:", error);
                            alert("Ocorreu um erro ao atualizar os dados do pet.");
                        }
                    }
                });
            }
        } else {
            alert("Pet não encontrado para edição.");
        }
    };
    request.onerror = (event) => {
        console.error("Erro ao carregar pet para edição:", event.target.errorCode);
        alert("Erro ao carregar dados do pet para edição.");
    };
}

// Salva a espécie selecionada no localStorage (se necessário para a próxima etapa)
function salvarEspecieLocalStorage() {
    const especie = document.querySelector('input[name="especie"]:checked')?.value;
    if (especie) {
        localStorage.setItem('especieSelecionada', especie);
    } else {
        localStorage.removeItem('especieSelecionada'); // Limpa se nada estiver selecionado
    }
}

// Botões e lógica de navegação - Adaptação para o fluxo de pets
document.addEventListener("DOMContentLoaded", () => {
    const botaoVoltar = document.querySelector(".botao-voltar");
    const botaoProsseguir = document.querySelector(".botao-prosseguir"); // Botão "Avançar para Etapa 3"

    // Event listener para o botão Voltar
    if (botaoVoltar) {
        botaoVoltar.addEventListener("click", () => {
            window.location.href = "etapa1.html"; // Volta para a página da Etapa 1 (Pessoa)
        });
    }

    // Event listener para o botão Avançar para Etapa 3
    if (botaoProsseguir) {
        botaoProsseguir.addEventListener("click", async (e) => {
            e.preventDefault(); // IMPEDE o redirecionamento padrão do onclick no HTML

            // Validação dos campos obrigatórios antes de salvar e navegar
            const nomePetInput = document.getElementById("nomePet");
            const especieInput = document.querySelector('input[name="especie"]:checked');

            if (!nomePetInput.value.trim()) {
                alert("Por favor, preencha o Nome do Pet.");
                nomePetInput.focus();
                return;
            }
            if (!especieInput) {
                alert("Por favor, selecione a Espécie do Pet (Cão ou Gato).");
                return;
            }

            const dadosDoPet = obterDadosFormulario();
            const editingId = document.getElementById("content").dataset.editingId;

            if (editingId) {
                dadosDoPet.id = editingId; // Usa o ID existente se estiver editando
            }

            try {
                await salvarPet(dadosDoPet); // Salva ou atualiza o pet
                alert("Dados do pet salvos com sucesso!");
                listarPets(); // Atualiza a tabela na página
                limparFormulario(); // Limpa o formulário após o salvamento

                // Só navega se o salvamento foi bem-sucedido
                window.location.href = 'etapa3.html';

            } catch (error) {
                console.error("Erro ao salvar os dados do pet:", error);
                alert("Ocorreu um erro ao salvar os dados do pet. Por favor, tente novamente.");
            }
        });
    }

    // Adiciona event listeners para os radio buttons de espécie para salvar no localStorage
    const radioCao = document.getElementById("cao");
    const radioGato = document.getElementById("gato");

    if (radioCao) {
        radioCao.addEventListener("change", salvarEspecieLocalStorage);
    }
    if (radioGato) {
        radioGato.addEventListener("change", salvarEspecieLocalStorage);
    }
    // Chame a função no carregamento para preencher o localStorage se houver um valor inicial
    salvarEspecieLocalStorage();
});

// Sincronizar (placeholder) - Adaptado para pets
function sincronizarCadastros() {
    alert("Funcionalidade de sincronização de pets ainda não implementada.");
}

// Função verificarEProsseguir que você tinha, não será mais chamada diretamente pelo HTML
// pois o botão "Avançar" agora tem um event listener que faz o salvamento e a navegação.
// Mantida aqui para referência, mas não usada.
/*
function verificarEProsseguir() {
    const especie = localStorage.getItem('especieSelecionada');
    if (!especie) {
        alert('Por favor, selecione uma espécie antes de avançar.');
        return;
    }
    window.location.href = 'etapa3.html';
}
*/

// Inicialização - Lista os pets ao carregar a página
listarPets();
</script> 
  
<!-- <script src="js/db.js"></script> -->
 <script src="js/app.js"></script>
  
</body>
</html>
